<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    
	<meta name="_csrf_parameter" th:content="${_csrf.parameterName}">
	<meta name="_csrf_header" th:content="${_csrf.headerName}">
	<meta name="_csrf" th:content="${_csrf.token}">

    <title>Cover Template for Bootstrap</title>

    <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.css" th:href="@{/css/bootstrap.css}" rel="stylesheet">
</head>
<body>

<div class="site-wrapper">
	<form id="frm">
	<div class="form-group">
		<label for="inputEmail3" class="col-sm-2 control-label">RSS URL</label>
		<div class="col-sm-10">
		    <input type="email" class="form-control" id="url" name="url" placeholder="RSS URL">
        </div>
	</div>
	<div class="form-group">
	    <div class="col-sm-offset-2 col-sm-10">
	        <input type="button" value="저장" onclick="save()" class="btn btn-default">
	    </div>
        <div class="col-sm-offset-2 col-sm-10">
            <input type="button" value="테스트" onclick="getCode()" class="btn btn-default">
        </div>
	</div>
	</form>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="/js/bootstrap.js" th:href="@{/js/bootstrap.js}"></script>

<script type="text/javascript">
/**
 * 저장
 */
function save() {
	$.ajax({
          type : "POST"
        , url : "/admin/news/main/save"
        , data : $("#frm").serialize()
        , error : function(){
            alert("error");
          }
        , success : function(data){
            alert("success");
          }
    });
}

function getCode() {
    $.ajax({
          type : "POST"
        , url : "/comm/getCommCodeList"
        , data : { "codeGroupId" : "G1" }
        , error : function(){
            alert("error");
          }
        , success : function(data){
            alert("success");
            alert(data.commCodeList[0].codeGroupId);
          }
    });
}

$(function () {
	//Spring Security csrf 관련 설정
    var token  = $("meta[name='_csrf']").attr("content");
    var header = $("meta[name='_csrf_header']").attr("content");
    
    $(document).ajaxSend(function(e, xhr, options) {
        if(token && header) {
            xhr.setRequestHeader(header, token);
        }
    });
});
</script>
</body>
</html>
